{"version":3,"sources":["../src/components/PageBuilder.ts"],"sourcesContent":["import { PageBuilder } from '@mindfiredigital/page-builder/dist/PageBuilder.js';\n\nexport interface PageBuilderDesign {\n  pages?: Array<{\n    id: string;\n    components: Array<{\n      type: string;\n      id: string;\n      props: Record<string, any>;\n    }>;\n  }>;\n  [key: string]: any;\n}\nexport class PageBuilderComponent extends HTMLElement {\n  private pageBuilder!: PageBuilder;\n  private initialized = false;\n  private _initialDesign: PageBuilderDesign | null = null;\n  private _editable: boolean | null = null;\n  private config = { Basic: [], Extra: [], Custom: [] };\n  private template = `<div id=\"app\">\n      <div id=\"sidebar\"></div>\n      <div id=\"canvas\" class=\"canvas\"></div>\n      <div id=\"customization\">\n        <h4 id=\"component-name\">Component: None</h4>\n        <div id=\"controls\"></div>\n        <div id=\"layers-view\" class=\"hidden\"></div>\n      </div>\n      <div id=\"notification\" class=\"notification hidden\"></div>\n      <div id=\"dialog\" class=\"dialog hidden\">\n        <div class=\"dialog-content\">\n          <p id=\"dialog-message\"></p>\n          <button id=\"dialog-yes\" class=\"dialog-btn\">Yes</button>\n          <button id=\"dialog-no\" class=\"dialog-btn\">No</button>\n        </div>\n      </div>\n    </div>`;\n\n  constructor() {\n    console.log('is it even being called');\n    super();\n    // Set inner HTML only if no child elements exist\n  }\n\n  // Observe 'config-data' attribute to detect changes\n  static get observedAttributes() {\n    return ['config-data'];\n  }\n\n  attributeChangedCallback(name: string, oldValue: string, newValue: string) {\n    if (name === 'config-data' && newValue !== oldValue) {\n      try {\n        const parsedConfig = JSON.parse(newValue);\n        this.config = parsedConfig;\n        if (\n          this.hasValidConfig() &&\n          Object.keys(this.config.Custom).length > 0\n        ) {\n          this.initialized = false;\n\n          this.initializePageBuilder();\n        }\n      } catch (e) {\n        console.error('Failed to parse config:', e);\n      }\n    }\n  }\n\n  set editable(value: boolean | null) {\n    console.log('called');\n    if (this._editable !== value) {\n      this._editable = value;\n      if (this.isConnected && this.hasValidConfig()) {\n        this.initializePageBuilder();\n      }\n    }\n  }\n\n  // Corrected getter for 'editable'\n  get editable(): boolean | null {\n    return this._editable;\n  }\n\n  set initialDesign(value: PageBuilderDesign | null) {\n    if (this._initialDesign !== value) {\n      this._initialDesign = value;\n      if (this.isConnected && this.hasValidConfig()) {\n        this.initializePageBuilder();\n      }\n    }\n  }\n\n  get initialDesign(): PageBuilderDesign | null {\n    return this._initialDesign;\n  }\n\n  // Lifecycle method: Called when the element is added to the DOM\n  connectedCallback() {\n    if (this.initialized) {\n      return;\n    }\n\n    setTimeout(() => {\n      if (!this.firstElementChild) {\n        this.innerHTML = this.template;\n      }\n\n      if (this.hasValidConfig()) {\n        this.initializePageBuilder();\n      }\n    }, 0);\n  }\n\n  private hasValidConfig(): boolean {\n    return (\n      this.config &&\n      (this.config.Basic?.length > 0 ||\n        this.config.Extra?.length > 0 ||\n        (this.config.Custom && Object.keys(this.config.Custom).length > 0))\n    );\n  }\n\n  // Initializes the PageBuilder instance\n  private initializePageBuilder() {\n    console.log('init'); // This log will now appear\n    if (this.initialized || !this.hasValidConfig()) {\n      return;\n    }\n\n    try {\n      const app = this.querySelector('#app');\n      if (app === null) {\n        console.error('Error: #app element not found.');\n        return;\n      }\n      if (app && this.pageBuilder) {\n        app.innerHTML = '';\n        this.innerHTML = this.template;\n      }\n      this.pageBuilder = new PageBuilder(\n        this.config,\n        this._initialDesign,\n        this._editable\n      );\n      this.initialized = true;\n      console.log(\n        'PageBuilderComponent: PageBuilder initialized successfully with config and initial design.'\n      );\n    } catch (error) {\n      console.error('Failed to initialize PageBuilder:', error);\n      this.initialized = false;\n    }\n  }\n}\n\n// Define the custom element if it hasn't been registered already\nif (!customElements.get('page-builder')) {\n  customElements.define('page-builder', PageBuilderComponent);\n}\n"],"mappings":"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","names":[]}